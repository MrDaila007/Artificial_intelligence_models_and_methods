# Лабораторная работа №1

## Тема: Задача распознавания образов без обучения

### Цель работы
Изучение и реализация алгоритма иерархической кластеризации для решения задачи распознавания образов без обучения.

---

## Теоретическая часть

### Постановка задачи T0

**ЗАДАНЫ:**
- Множество объектов X, разбитое на подмножества (классы) X₁, ..., Xₗ (l ∈ ℕ)
- Классы не пересекаются: Xᵢ ∩ Xⱼ = ∅ для всех i ≠ j
- Выборка объектов X⁰ ⊂ X, для которой известна принадлежность к классам

**Информационный вектор:**
```
P(x) = (P₁(x), ..., Pₗ(x)), где Pᵢ(x) = 1 если x ∈ Xᵢ, иначе 0
```

### Задача T1 (Распознавание без обучения)

Требуется множество объектов X⁰ разбить на конечное число подмножеств (классов, таксонов, кластеров). В идеальном случае полученные классы должны соответствовать разбиению множества X на классы.

---

## Алгоритм иерархической кластеризации

### Шаг 0 (предварительный)
Формируем первоначальный набор классов. Каждый объект из X⁰ отождествляем с классом X'ᵢ. Всего классов: |X⁰| = k.
Обозначим набор классов: X' = (X'₁, ..., X'ₖ)

### Шаг 1
Для каждого класса X'ᵢ ∈ X' определяем центроид:
```
xᵢ = (∑ xᵤ) × (|X'ᵢ|)⁻¹,  где xᵤ ∈ X'ᵢ
```

### Шаг 2
С помощью функции попарного сравнения s: X × X → ℝ находим ближайшие классы X'ₛ и X'ₜ. Объединяем их в новый класс X'ₛₜ.

**Метрики для сравнения:**
- **Метрика Евклида:** s(x₁, x₂) = √(∑(x₁ᵢ - x₂ᵢ)²)
- **Метрика Минковского:** s(x₁, x₂) = (∑|x₁ᵢ - x₂ᵢ|ᵖ)^(1/p)
- **Метрика Хэмминга:** s(x₁, x₂) = ∑|x₁ᵢ - x₂ᵢ|

### Шаг 3
Модифицируем набор классов X': исключаем X'ₛ, X'ₜ и добавляем X'ₛₜ.

### Шаг 4
Если |X'| = l, алгоритм завершается. Иначе → Шаг 1.

---

## Результаты работы алгоритма

Получаем набор классов X' = (X'₁, ..., X'ₗ) и кластеризационный вектор:
```
C(x) = (C₁(x), ..., Cₗ(x)), где Cᵢ(x) = 1 если x ∈ X'ᵢ, иначе 0
```

### Мера несоответствия информации
```
μ(T₀, T₁) = (∑(|X'ᵢ| - b'ᵢ)) × |X⁰|⁻¹
```

---

## Задание

1. Выбрать датасет из предложенного списка
2. Реализовать алгоритм иерархической кластеризации
3. Вычислить меру несоответствия информации μ(T₀, T₁)
4. Создать графический интерфейс для визуализации результатов

---

## Требования к программному продукту

1. **Любой язык программирования** (рекомендуется Python)
2. **Графический интерфейс обязателен**
3. **Вывод на экран по запросу:**
   - Разбиение X' = (X'₁, ..., X'ₗ)
   - Мера несоответствия μ(T₀, T₁)

---

## Практическая часть

### Структура реализации
- `solution.py` — консольная и tkinter-версия алгоритма, содержит класс `HierarchicalClustering` и вспомогательные функции.
- `app.py` — Streamlit-интерфейс для загрузки CSV, выбора признаков и настройки параметров кластеризации.
- `data/` (в корне репозитория) — тестовые CSV, например `iris.csv`, которые подходят для быстрой проверки.

### Подготовка окружения
```bash
cd Artificial_intelligence_models_and_methods
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### Запуск
- **Консоль / tkinter**  
  ```bash
  python Lab1/solution.py --input data/iris.csv --metric euclidean --clusters 3
  ```  
  При наличии tkinter откроется GUI, иначе скрипт выполнится в консоли.

- **Web-интерфейс**  
  ```bash
  streamlit run Lab1/app.py
  ```  
  В браузере доступны загрузка файла, выбор колонок для анализа и отображение дендрограммы.

### Формат входных данных
- CSV с заголовком.
- Числовые признаки (int/float); категориальный столбец с метками классов (необязателен, но нужен для оценки μ).
- Значения должны быть нормализованы или приведены к сопоставимому масштабу для корректного выбора метрик.

### Проверка работоспособности
Полный набор автоматических проверок запускается из корня проекта:
```bash
./venv/bin/python test_web.py
```
Скрипт соберёт синтетические данные, выполнит кластеризацию и убедится, что μ(T₀, T₁) рассчитывается корректно.

---

## Рекомендуемые датасеты

- [Биткойн, исторические данные](https://www.kaggle.com/mczielinski/bitcoin-historical-data)
- [FIFA 19 полный набор данных игроков](https://www.kaggle.com/karangadiya/fifa19)
- [Статистика видео YouTube](https://www.kaggle.com/datasnaek/youtube-new)
- [Датасет болезней сердца](https://www.kaggle.com/ronitf/heart-disease-uci)
- [Распознавание пола по голосу](https://www.kaggle.com/primaryobjects/voicegender)
- [Качество красного вина](https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009)
- [Распознавание цветов](https://www.kaggle.com/alxmamaev/flowers-recognition)
- [Обнаружение мошенничества с кредитными картами](https://www.kaggle.com/mlg-ulb/creditcardfraud)

---

## Контрольные вопросы

1. В чём отличие задачи распознавания без обучения от задачи с обучением?
2. Опишите алгоритм иерархической кластеризации.
3. Какие метрики можно использовать для сравнения объектов?
4. Как вычисляется мера несоответствия информации?
5. Что такое информационный и кластеризационный векторы?
